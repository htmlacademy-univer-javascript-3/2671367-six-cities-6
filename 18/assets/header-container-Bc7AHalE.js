import{t as y,b as k,v as S,w as A,u as x,e as p,m as v,A as j,c as b,r as _,j as s,L as u,x as h,y as w,z as C,B as O}from"./index-BdpeEhiR.js";var f={exports:{}};var N;function F(){return N||(N=1,(function(e){(function(){var i={}.hasOwnProperty;function a(){for(var r=[],n=0;n<arguments.length;n++){var t=arguments[n];if(t){var o=typeof t;if(o==="string"||o==="number")r.push(t);else if(Array.isArray(t)){if(t.length){var l=a.apply(null,t);l&&r.push(l)}}else if(o==="object"){if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]")){r.push(t.toString());continue}for(var c in t)i.call(t,c)&&t[c]&&r.push(c)}}}return r.join(" ")}e.exports?(a.default=a,e.exports=a):window.classNames=a})()})(f)),f.exports}var L=F();const g=y(L),M=()=>k(e=>e.offer.filterBy),T=()=>{const e=S();return i=>{e(A.setSort(i))}},P=e=>{const i=k(a=>a.offer.favoriteOffers);return e?i[e]??[]:Object.values(i).filter(Boolean).flat()},B=({offer:e,variant:i="cities",onMouseEnter:a,onMouseLeave:r})=>{const n=x(),o=p(v)===j.Auth,l=b(),[c,m]=_.useState(!1),d=async()=>{if(!o){l(h.Login);return}if(!c){m(!0);try{await n(w({id:e.id,status:e.isFavorite?0:1})).unwrap()}catch{}finally{m(!1)}}};return s.jsxs("article",{className:`${i}__card place-card`,onMouseEnter:a,onMouseLeave:r,children:[e.isPremium&&s.jsx("div",{className:"place-card__mark",children:s.jsx("span",{children:"Premium"})}),s.jsx("div",{className:`${i}__image-wrapper place-card__image-wrapper`,children:s.jsx("a",{href:"#",children:s.jsx("img",{className:"place-card__image",src:e.previewImage,width:"260",height:"200",alt:e.title})})}),s.jsxs("div",{className:"place-card__info",children:[s.jsxs("div",{className:"place-card__price-wrapper",children:[s.jsxs("div",{className:"place-card__price",children:[s.jsxs("b",{className:"place-card__price-value",children:["€",e.price]}),s.jsx("span",{className:"place-card__price-text",children:"/ night"})]}),s.jsxs("button",{className:`place-card__bookmark-button button${e.isFavorite?" place-card__bookmark-button--active":""}`,type:"button",onClick:()=>void d(),disabled:c,"aria-busy":c,children:[s.jsx("svg",{className:"place-card__bookmark-icon",width:"18",height:"19",children:s.jsx("use",{xlinkHref:"#icon-bookmark"})}),s.jsx("span",{className:"visually-hidden",children:e.isFavorite?"In bookmarks":"To bookmarks"})]})]}),s.jsx("div",{className:"place-card__rating rating",children:s.jsxs("div",{className:"place-card__stars rating__stars",children:[s.jsx("span",{style:{width:`${e.rating*20}%`}}),s.jsx("span",{className:"visually-hidden",children:"Rating"})]})}),s.jsx("h2",{className:"place-card__name",children:s.jsx(u,{to:`/offer/${e.id}`,children:e.title})}),s.jsx("p",{className:"place-card__type",children:e.type})]})]})},z=({offers:e,variant:i="cities",onOfferHover:a})=>{const r=i==="cities"?"cities__places-list places__list tabs__content":"near-places__list places__list";return s.jsx("div",{className:r,children:e.map(n=>s.jsx(B,{offer:n,variant:i,onMouseEnter:a?()=>a(n.id):void 0,onMouseLeave:a?()=>a(null):void 0},n.id))})},E=({offer:e,reviews:i})=>{const a=_.useMemo(()=>e.rating*20,[e.rating]),r=x(),t=p(v)===j.Auth,o=b(),[l,c]=_.useState(!1),m=async()=>{if(!t){o(h.Login);return}if(!l){c(!0);try{await r(w({id:e.id,status:e.isFavorite?0:1})).unwrap()}catch{}finally{c(!1)}}};return s.jsxs("section",{className:"offer",children:[s.jsx("div",{className:"offer__gallery-container container",children:s.jsx("div",{className:"offer__gallery",children:e.images.map(d=>s.jsx("div",{className:"offer__image-wrapper",children:s.jsx("img",{className:"offer__image",src:d,alt:"Offer view"})},d))})}),s.jsx("div",{className:"offer__container container",children:s.jsxs("div",{className:"offer__wrapper",children:[e.isPremium&&s.jsx("div",{className:"offer__mark",children:s.jsx("span",{children:"Premium"})}),s.jsxs("div",{className:"offer__name-wrapper",children:[s.jsx("h1",{className:"offer__name",children:e.title}),s.jsxs("button",{className:g("offer__bookmark-button button",{"offer__bookmark-button--active":e.isFavorite}),type:"button",onClick:()=>void m(),disabled:l,"aria-busy":l,children:[s.jsx("svg",{className:"offer__bookmark-icon",width:"31",height:"33",children:s.jsx("use",{xlinkHref:"#icon-bookmark"})}),s.jsx("span",{className:"visually-hidden",children:"To bookmarks"})]})]}),s.jsxs("div",{className:"offer__rating rating",children:[s.jsxs("div",{className:"offer__stars rating__stars",children:[s.jsx("span",{style:{width:`${a}%`}}),s.jsx("span",{className:"visually-hidden",children:"Rating"})]}),s.jsx("span",{className:"offer__rating-value rating__value",children:e.rating})]}),s.jsxs("ul",{className:"offer__features",children:[s.jsx("li",{className:"offer__feature offer__feature--entire",children:e.type}),s.jsxs("li",{className:"offer__feature offer__feature--bedrooms",children:[e.bedrooms," Bedrooms"]}),s.jsxs("li",{className:"offer__feature offer__feature--adults",children:["Max ",e.maxAdults," adults"]})]}),s.jsxs("div",{className:"offer__price",children:[s.jsxs("b",{className:"offer__price-value",children:["€",e.price]}),s.jsx("span",{className:"offer__price-text",children:" night"})]}),s.jsxs("div",{className:"offer__inside",children:[s.jsx("h2",{className:"offer__inside-title",children:"What's inside"}),s.jsx("ul",{className:"offer__inside-list",children:e.goods.map(d=>s.jsx("li",{className:"offer__inside-item",children:d},d))})]}),s.jsxs("div",{className:"offer__host",children:[s.jsx("h2",{className:"offer__host-title",children:"Meet the host"}),s.jsxs("div",{className:"offer__host-user user",children:[s.jsx("div",{className:g("offer__avatar-wrapper","user__avatar-wrapper",{"offer__avatar-wrapper--pro":e.host.isPro}),children:s.jsx("img",{className:"offer__avatar user__avatar",src:e.host.avatarUrl,width:74,height:74,alt:e.host.name})}),s.jsx("span",{className:"offer__user-name",children:e.host.name}),e.host.isPro&&s.jsx("span",{className:"offer__user-status",children:"Pro"})]}),s.jsx("div",{className:"offer__description",children:s.jsx("p",{className:"offer__text",children:e.description})})]}),i]})})]})},H=_.memo(E);function R({email:e,favoriteCount:i=0,isAuth:a,onLogout:r}){return s.jsx("header",{className:"header",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"header__wrapper",children:[s.jsx("div",{className:"header__left",children:s.jsx(u,{to:h.Root,className:"header__logo-link",children:s.jsx("img",{className:"header__logo",src:"/img/logo.svg",alt:"6 cities logo",width:"81",height:"41"})})}),s.jsx("nav",{className:"header__nav",children:s.jsxs("ul",{className:"header__nav-list",children:[s.jsx("li",{className:"header__nav-item user",children:s.jsxs(u,{className:"header__nav-link header__nav-link--profile",to:h.Favorites,children:[s.jsx("div",{className:"header__avatar-wrapper user__avatar-wrapper"}),s.jsx("span",{className:"header__user-name user__name",children:e??"Guest"}),s.jsx("div",{children:a?s.jsx("span",{className:"header__favorite-count",children:i}):void 0})]})}),s.jsx("li",{className:"header__nav-item",children:a?s.jsx("button",{className:"header__nav-link header__signout",type:"button",onClick:r,children:"Sign out"}):s.jsx(u,{className:"header__nav-link header__signin",to:h.Login,children:"Sign in"})})]})})]})})})}const $=_.memo(R);function q(){const e=p(c=>c.user.user),i=p(v),a=x(),r=P(),n=i===j.Auth,t=e?.email,o=n?r.length:0;_.useEffect(()=>{n&&a(C())},[a,n]);const l=()=>{a(O())};return s.jsx($,{email:t,favoriteCount:o,isAuth:n,onLogout:l})}export{q as H,z as O,T as a,P as b,g as c,H as d,M as u};
